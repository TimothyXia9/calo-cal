## 食物卡路里分析项目总结文档

## 项目概述

基于 Notion 前端 + 本地 Mac 后端的食物卡路里分析系统，用户可通过图片或文字描述记录食物，系统自动分析并计算卡路里含量。
或直接连接至前端，进行用户互动。

## 技术架构

### 整体架构设计

```
用户输入（Notion）→ Webhook → 本地处理服务 → AI分析 → 营养数据库 → 结果回写（Notion）

```

### 核心组件

1. **前端**：Notion 数据库作为用户界面
2. **后端**：Mac 本地服务处理 AI 推理
3. **AI 模型**：多模态融合分析（图像+文本）
4. **数据源**：营养数据库查询

## Notion 数据库设计

### 主表：Food Log

| 字段名   | 类型         | 说明                  | 示例                           |
| -------- | ------------ | --------------------- | ------------------------------ |
| 名称     | Title        | 记录名称              | "2024-06-02 午餐"              |
| 图片     | Files        | 用户上传的图片        | food_photo.jpg                 |
| 描述     | Rich Text    | 用户输入的文字描述    | "一份鸡肉沙拉配全麦面包"       |
| 食物类型 | Multi-select | 识别出的食物种类      | 鸡肉, 生菜, 全麦面包           |
| 提取结果 | Rich Text    | 详细的分量描述        | 鸡肉:100g, 生菜:50g, 面包:2 片 |
| 热量     | Number       | 计算出的总卡路里      | 420                            |
| 处理状态 | Select       | 待处理/处理中/已完成/ | 已完成                         |

### VLM 模型（优先推荐）

-   **API 服务**：GPT-4V / Claude 3.5 Sonnet
-   **本地部署**：InternVL3（1B/2B 参数模型）

### 融合策略

1. **置信度权重融合**：高置信度结果优先
2. **智能冲突仲裁**：规则引擎 + LLM 判断
3. **渐进式确认**：不确定时询问用户
